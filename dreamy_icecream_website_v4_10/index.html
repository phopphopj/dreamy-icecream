<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>dreamy icecream — happiness in a cup</title>
  <meta name="description" content="dreamy icecream — bangkok delivery. happiness in a cup." />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="topbar">
    <div class="container topbar-inner">
      <a class="brand" href="#home" aria-label="dreamy icecream home">
        <img class="brand-mark" src="assets/logo.jpg" alt="dreamy icecream logo" />
        <span class="brand-text">dreamy icecream</span>
      </a>

      <nav class="nav" aria-label="site navigation">
        <a href="#home">home</a>
        <a href="#about">about</a>
        <a href="#flavors">flavors</a>
        <a href="#menu">menu</a>
        <a href="#reviews">reviews</a>
        <a href="#order" class="nav-cta">order</a>
      </nav>
    </div>
  </header>

  <main id="home">
    <section class="hero" id="home">
      <div class="container hero-clean">
        <div class="hero-center">
          <img class="hero-logo-big" src="assets/logo.jpg" alt="dreamy icecream logo" />
          <h1>dreamy icecream</h1>
          <p class="lead lead-center">happiness in a cup.</p>

          <div class="hero-buttons">
            <a class="btn btn-primary" href="#order">order</a>
            <a class="btn btn-ghost" href="#menu">menu</a>
            <a class="btn btn-ghost" href="#reviews">reviews</a>
          </div>

          <div class="hero-sub">
            <span class="badge">bangkok delivery</span>
</div>
        </div>

        <div class="hero-photo-card" aria-hidden="true">
          <img class="hero-photo-soft" src="assets/cups.jpg" alt="" />
        </div>
      </div>
    </section>

    <section class="section" id="about">
      <div class="container">
        <div class="section-head">
          <h2>about dreamy icecream</h2>
          <p>
            dreamy icecream is all about consistency, thoughtful presentation, and great service — delivered right to you in bangkok.
          </p>
        </div>

        <div class="grid-3">
          <div class="card">
            <h3>simple ordering</h3>
            <p>order through instagram dms and we’ll confirm your details fast.</p>
          </div>
          <div class="card">
            <h3>clean + playful</h3>
            <p>bold colors, cute labels, and a vibe that feels fun without being messy.</p>
          </div>
          <div class="card">
            <h3>delivery only</h3>
            <p>no physical shop — just delivery for convenience.</p>
          </div>
        </div>
      </div>
    </section>

    <section class="section" id="flavors">
      <div class="container">
        <div class="section-head">
          <h2>flavors</h2>
          <p>the classic lineup.</p>
        </div>

        <div class="flavor-grid">

          <article class="flavor-card">
            <div class="flavor-imgwrap">
              <img src="assets/birthday_party.jpg" alt="birthday party">
            </div>
            <div class="flavor-body">
              <h3>birthday party</h3>
              <p>fun party-style flavor with colorful vibes.</p>
              <span class="pill pill-purple">classic</span>
            </div>
          </article>

          <article class="flavor-card">
            <div class="flavor-imgwrap">
              <img src="assets/unicorn_dream.jpg" alt="unicorn dream">
            </div>
            <div class="flavor-body">
              <h3>unicorn dream</h3>
              <p>candy floss with marshmallow.</p>
              <span class="pill pill-purple">classic</span>
            </div>
          </article>

          <article class="flavor-card">
            <div class="flavor-imgwrap">
              <img src="assets/muddy_snowman.jpg" alt="muddy snowman">
            </div>
            <div class="flavor-body">
              <h3>muddy snowman</h3>
              <p>chocolate + marshmallow vibes.</p>
              <span class="pill pill-red">classic</span>
            </div>
          </article>

          <article class="flavor-card">
            <div class="flavor-imgwrap">
              <img src="assets/jello_demo.jpg" alt="jello demo">
            </div>
            <div class="flavor-body">
              <h3>jello demo</h3>
              <p>betagen with jelly.</p>
              <span class="pill pill-yellow">classic</span>
            </div>
          </article>

          <article class="flavor-card">
            <div class="flavor-imgwrap">
              <img src="assets/phops_balloon_pop.jpg" alt="phop’s balloon pop">
            </div>
            <div class="flavor-body">
              <h3>phop’s balloon pop</h3>
              <p>frozen yogurt and red jelly.</p>
              <span class="pill pill-green">classic</span>
            </div>
          </article>
        </div>
      </div>
    </section>

    <section class="section" id="menu">
      <div class="container">
        <div class="section-head">
          <h2>menu</h2>
          <p></p>
        </div>

        <div class="menu-wrap">
          <a class="menu-link" href="assets/menu.png" target="_blank" rel="noreferrer">
            <img class="menu-img" src="assets/menu.png" alt="dreamy icecream menu" />
          </a>
          <div class="menu-side">
            <div class="card">
              <h3>quick notes</h3>
              <ul class="list">
                <li>tap the menu to open full size</li>
                <li>pricing shown: 80 thb per cup</li>
                </ul>
            </div>
</div>
        </div>
      </div>
    </section>

    <section class="section" id="order">
      <div class="container">
        <div class="section-head">
          <h2>order</h2>
          <p>main ordering: line. instagram is the place to see updates and flavors.</p>
        </div>

        <div class="order-grid">
          <div class="card">
            <h3>line (main)</h3>
            <p class="muted">order by messaging us on line. if you don’t have our line yet, dm us on instagram and we’ll send it.</p>
          </div>

          <div class="card">
            <h3>instagram (updates)</h3>
            <p class="big">@dreamyicecream.official</p>
            <p class="muted">use instagram to see the menu, announcements, and new drops.</p>
            <div class="order-actions">
              <a class="btn btn-primary" href="https://instagram.com/dreamyicecream.official" target="_blank" rel="noreferrer">open instagram</a>
              <button class="btn btn-ghost" type="button" id="copy-ig">copy handle</button>
            </div>
          </div>

          <div class="card">
            <h3>delivery area</h3>
            <p class="muted">bangkok delivery only. if you’re outside the area, please arrange your own messenger service to pick up and deliver.</p>
          </div>
        </div>
      </div>
    </section>

    
    <section class="section" id="reviews">
      <div class="container">
        <div class="section-head">
          <h2>customer reviews</h2>
          <p>real reviews — everyone can see them.</p>
        </div>

        <div class="reviews-grid">
          <div class="card">
            <h3>leave a review</h3>

            <div class="setup-note">
              <div class="setup-title">setup for netlify (1 minute)</div>
              <ol class="setup-list">
                <li>create a free <span class="mono">supabase</span> project</li>
                <li>create table <span class="mono">reviews</span> (script is in <span class="mono">readme.txt</span>)</li>
                <li>paste your <span class="mono">supabase url</span> + <span class="mono">anon key</span> below (in <span class="mono">index.html</span>)</li>
              </ol>
              <div class="muted tiny">until keys are added, the form will show a setup message.</div>
            </div>

            <form id="review-form" class="review-form">
              <label class="field">
                <span class="label">name (optional)</span>
                <input class="input" type="text" id="review-name" placeholder="your name" maxlength="30" />
              </label>

              <label class="field">
                <span class="label">star rating</span>
                <select class="input" id="review-stars" required>
                  <option value="5">5 stars</option>
                  <option value="4">4 stars</option>
                  <option value="3">3 stars</option>
                  <option value="2">2 stars</option>
                  <option value="1">1 star</option>
                </select>
              </label>

              <label class="field">
                <span class="label">your review</span>
                <textarea class="input textarea" id="review-text" placeholder="what did you like?" maxlength="240" required></textarea>
              </label>

              <div class="order-actions">
                <button class="btn btn-primary" type="submit">post review</button>
              </div>

              <p class="muted tiny" id="review-status"></p>
            </form>
          </div>

          <div class="card">
            <div class="reviews-head">
              <h3>latest</h3>
              <div class="rating-pill" id="rating-pill">loading…</div>
            </div>
            <div id="reviews-list" class="reviews-list"></div>
          </div>
        </div>
      </div>
    </section>


    <footer class="footer">
      <div class="container footer-inner">
        <div class="footer-left">
          <img class="footer-logo" src="assets/logo.jpg" alt="dreamy icecream logo" />
          <div>
            <div class="footer-title">dreamy icecream</div>
            <div class="footer-sub">happiness in a cup</div>
          </div>
        </div>

        <div class="footer-right">
          <a href="#home">back to top</a>
          <span class="dot">•</span>
          <a href="https://instagram.com/dreamyicecream.official" target="_blank" rel="noreferrer">instagram</a>
        </div>
      </div>
    </footer>
  </main>

  <script>
    // instagram copy
    const copy = async (text) => {
      try { await navigator.clipboard.writeText(text); return true; }
      catch { return false; }
    };

    const igBtn = document.getElementById('copy-ig');
    igBtn?.addEventListener('click', async () => {
      const ok = await copy('@dreamyicecream.official');
      igBtn.textContent = ok ? 'copied' : 'copy failed';
      setTimeout(() => (igBtn.textContent = 'copy handle'), 1100);
    });

    // ---------------------------
    // shared reviews (supabase)
    // ---------------------------
    // 1) create a supabase project
    // 2) create table + rls (see readme.txt)
    // 3) paste your keys here:

    const SUPABASE_URL = "";      // e.g. https://xxxx.supabase.co
    const SUPABASE_ANON_KEY = ""; // anon public key

    const statusEl = document.getElementById('review-status');
    const listEl = document.getElementById('reviews-list');
    const pillEl = document.getElementById('rating-pill');

    const starRow = (n) => '★★★★★'.slice(0, n) + '☆☆☆☆☆'.slice(0, 5 - n);

    const setStatus = (t) => { if (statusEl) statusEl.textContent = t || ""; };

    const canRun = () => SUPABASE_URL.trim() && SUPABASE_ANON_KEY.trim();

    const fetchReviews = async () => {
      if (!canRun()) {
        if (pillEl) pillEl.textContent = 'setup needed';
        if (listEl) listEl.innerHTML = '<div class="empty">reviews are not enabled yet. add supabase keys in index.html.</div>';
        return [];
      }

      const url = `${SUPABASE_URL}/rest/v1/reviews?select=id,name,stars,text,created_at&order=id.desc&limit=50`;
      const res = await fetch(url, {
        headers: {
          apikey: SUPABASE_ANON_KEY,
          authorization: `Bearer ${SUPABASE_ANON_KEY}`
        }
      });

      if (!res.ok) throw new Error('failed to load reviews');
      return await res.json();
    };

    const render = async () => {
      try {
        const reviews = await fetchReviews();
        if (!Array.isArray(reviews) || !listEl) return;

        if (reviews.length === 0) {
          listEl.innerHTML = '<div class="empty">no reviews yet. be the first one.</div>';
          if (pillEl) pillEl.textContent = '0 reviews';
          return;
        }

        const avg = reviews.reduce((s, r) => s + (Number(r.stars) || 0), 0) / reviews.length;
        if (pillEl) pillEl.textContent = `${avg.toFixed(1)} / 5 • ${reviews.length} review${reviews.length === 1 ? '' : 's'}`;

        listEl.innerHTML = reviews.map(r => {
          const name = (r.name || 'anonymous').replace(/</g,'&lt;').replace(/>/g,'&gt;');
          const text = (r.text || '').replace(/</g,'&lt;').replace(/>/g,'&gt;');
          const stars = Math.max(1, Math.min(5, Number(r.stars) || 5));
          const date = r.created_at ? new Date(r.created_at).toLocaleDateString() : '';
          return `
            <div class="review">
              <div class="review-top">
                <div class="review-name">${name}</div>
                <div class="review-stars" aria-label="${stars} out of 5 stars">${starRow(stars)}</div>
              </div>
              <div class="review-text">${text}</div>
              <div class="review-date">${date}</div>
            </div>
          `;
        }).join('');
      } catch (e) {
        if (pillEl) pillEl.textContent = 'error';
        if (listEl) listEl.innerHTML = '<div class="empty">could not load reviews. check supabase setup.</div>';
      }
    };

    const postReview = async ({ name, stars, text }) => {
      const url = `${SUPABASE_URL}/rest/v1/reviews`;
      const res = await fetch(url, {
        method: 'POST',
        headers: {
          'content-type': 'application/json',
          apikey: SUPABASE_ANON_KEY,
          authorization: `Bearer ${SUPABASE_ANON_KEY}`,
          prefer: 'return=minimal'
        },
        body: JSON.stringify({ name, stars, text })
      });
      if (!res.ok) throw new Error('failed to post');
    };

    const form = document.getElementById('review-form');
    form?.addEventListener('submit', async (e) => {
      e.preventDefault();
      setStatus('');

      if (!canRun()) {
        setStatus('setup needed: add supabase url + anon key in index.html');
        return;
      }

      const name = (document.getElementById('review-name')?.value || '').trim();
      const stars = parseInt(document.getElementById('review-stars')?.value || '5', 10);
      const text = (document.getElementById('review-text')?.value || '').trim();
      if (!text) return;

      try {
        setStatus('posting…');
        await postReview({ name, stars: Math.max(1, Math.min(5, stars)), text });
        const t = document.getElementById('review-text');
        if (t) t.value = '';
        setStatus('posted');
        await render();
        setTimeout(() => setStatus(''), 1200);
      } catch {
        setStatus('could not post. check supabase rls + keys.');
      }
    });

    render();
  </script>
</body>
</html>
